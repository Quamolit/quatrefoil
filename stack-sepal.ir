{:definitions {"core/render-canvas!" ["defn" "render-canvas!" ["markup" "states" "instants" "scene"] ["let" [["new-tree" ["render-component" "markup" "@tree-ref" ["[]"] "states" "instants"]]] ["if" ["some?" "@tree-ref"] ["let" [["changes-ref" ["atom" ["[]"]]] ["collect!" ["fn" ["x"] ["swap!" "changes-ref" "conj" "x"]]]] ["diff-tree" "@tree-ref" "new-tree" ["[]"] "collect!"] [".log" "js/console" "@changes-ref"]] [".add" "scene" ["build-tree" ["[]"] ["purify-tree" "new-tree"]]]] ["reset!" "tree-ref" "new-tree"] [".log" "js/console" "|Tree:" "new-tree"]]], "main/dispatch!" ["defn" "dispatch!" ["op" "op-data"]], "dsl.alias/sphere" ["defn" "sphere" ["props" "&" "children"] ["create-element" ":sphere" "props" "children"]], "dsl.render/render-component" ["defn" "render-component" ["markup" "prev-tree" "coord" "states" "instants"] ["if" ["and" ["some?" "prev-tree"] ["let" [["prev-args" [":args" "prev-tree"]] ["prev-states" [":states" "prev-tree"]] ["prev-instants" [":instants" "prev-tree"]]] ["and" ["=seq?" [":args" "markup"] "prev-args"] ["identical?" "states" "prev-states"] ["identical?" "instants" "prev-instants"]]]] "prev-tree" ["let" [["comp-name" [":name" "markup"]] ["mutate!" ["fn" ["&" "args"] ["println" "|Mutate:" "args"]]] ["tree" ["->" [":render" "markup"] ["apply" [":args" "markup"]] ["apply" ["list" ["get" "states" "'data"] "mutate!" ["get" "instants" "'data"]]] ["render-markup" [":tree" "prev-tree"] ["conj" "coord" "comp-name"] "coord" ["get" "states" "comp-name"] ["get" "instants" "comp-name"]]]]] ["merge" "markup" ["{}" [":tree" "tree"] [":states" "states"] [":instants" "instants"]]]]]], "dsl.render/render-shape" ["defn" "render-shape" ["markup" "prev-markup" "coord" "comp-coord" "states" "instants"] ["let" [["prev-children" [":children" "prev-markup"]]] ["update" "markup" ":children" ["fn" ["children"] ["->>" "children" ["map" ["fn" ["entry"] ["update" "entry" "1" ["fn" ["child"] ["let" [["k" ["first" "entry"]]] ["render-markup" "child" ["get" "prev-children" "k"] ["conj" "coord" "k"] "comp-coord" ["get" "states" "k"] ["get" "instants" "k"]]]]]]] ["into" ["{}"]]]]]]], "dsl.alias/group" ["defn" "group" ["props" "&" "children"] ["create-element" ":group" "props" "children"]], "main/-main!" ["defn" "-main!" [] ["enable-console-print!"] ["devtools/install!"] ["if" ["not" ["empty?" "ssr-stages"]] ["let" [["target" [".querySelector" "js/document" "|#app"]]] ["falsify-stage!" "target" ["render-element" ["comp-container" "@store-ref" "ssr-stages"] "states-ref"] "dispatch!"]]] ["render-app!"] ["reset!" "renderer-ref" ["js/THREE.WebGLRenderer." ["clj->js" ["{}" [":canvas" ["js/document.querySelector" "|canvas"]] [":antialias" "true"]]]]] [".setSize" "@renderer-ref" "js/window.innerWidth" "js/window.innerHeight"] ["render-canvas-app!"] ["add-watch" "store-ref" ":changes" "render-canvas-app!"] ["add-watch" "states-ref" ":changes" "render-canvas-app!"] ["println" "|App started!"]], "dsl.object3d-dom/camera-ref" ["def" "camera-ref" ["atom" ["js/THREE.PerspectiveCamera." "45" ["/" "js/window.innerWidth" "js/window.innerHeight"] "0.1" "1000"]]], "main/on-jsload!" ["defn" "on-jsload!" [] ["render-canvas-app!"] ["println" "|Code updated."]], "dsl.alias/cube" ["defn" "cube" ["props" "&" "children"] ["create-element" ":cube" "props" "children"]], "comp.canvas/comp-canvas" ["def" "comp-canvas" ["create-comp" ":canvas" ["{}"] ["fn" ["store"] ["fn" ["state" "mutate!" "instant"] ["group" ["{}"] ["comp-demo"]]]]]], "main/render-app!" ["defn" "render-app!" [] ["let" [["target" [".querySelector" "js/document" "|#app"]]] ["render!" ["comp-container" "@store-ref"] "target" "dispatch!" "states-ref"]]], "dsl.object3d-dom/build-tree" ["defn" "build-tree" ["coord" "tree"] ["let" [["object3d" ["create-element" ["dissoc" "tree" ":children"]]] ["children" ["->>" [":children" "tree"] ["map" ["fn" ["entry"] ["update" "entry" "1" ["fn" ["child"] ["build-tree" ["conj" "coord" ["first" "entry"]]]]]]] ["into" ["{}"]]]] ["virtual-element" ["{}" [":object3d" "object3d"] [":children" "children"]]]] [".log" "js/console" "children"] ["doseq" ["[]" "entry" "children"] ["let" [["child" ["last" "entry"]]] [".log" "js/console" "|Child:" "child" "entry"] [".add" "object3d" "child"]]] ["swap!" "virtual-tree-ref" "assoc-in" ["conj" "coord" "'data"] "virtual-element"] "object3d"]], "dsl.diff/diff-params" ["defn" "diff-params" ["prev-params" "params" "coord" "collect!"]], "dsl.alias/create-comp" ["defn" "create-comp" ["comp-name" "hooks" "render"] ["fn" ["&" "args"] ["Component." "comp-name" "args" ["{}"] ["{}"] "render" "nil" ["merge" "basic-hooks" "hooks"] "false"]]], "dsl.alias/create-element" ["defn" "create-element" ["el-name" "props" "children"] ["Shape." "el-name" "props" ["if" ["seq?" "children"] ["->>" "children" ["map-indexed" "vector"] ["into" ["{}"]]] "children"]]], "dsl.object3d-dom/virtual-tree-ref" ["defonce" "virtual-tree-ref" ["atom" ["{}"]]], "comp.canvas/comp-demo" ["def" "comp-demo" ["create-comp" ":demo" "nil" ["fn" [] ["fn" ["state" "mutate!" "instant"] ["group" ["{}"] ["cube" ["{}"]]]]]]], "dsl.object3d-dom/set-event" ["defn" "set-event" []], "util.core/purify-tree" ["defn" "purify-tree" ["tree"] ["if" ["comp?" "tree"] ["recur" [":tree" "tree"]] ["update" "tree" ":children" ["fn" ["children"] ["->>" "children" ["map" ["fn" ["entry"] ["update" "entry" "1" ["fn" ["child"] ["purify-tree" "child"]]]]] ["into" ["{}"]]]]]]], "dsl.object3d-dom/remove-child" ["defn" "remove-child" []], "util.core/=seq?" ["defn" "=seq?" ["xs" "ys"] ["let" [["xs-empty?" ["empty?" "xs"]] ["ys-empty?" ["empty?" "ys"]]] ["if" "xs-empty?" "ys-empty?" ["if" "ys-empty?" ["if" ["identical?" ["first" "xs"] ["first" "ys"]] ["recur" ["rest" "xs"] ["rest" "ys"]] "false"]]]]], "dsl.object3d-dom/create-element" ["defn" "create-element" ["element"] ["js/THREE.Object3D."]], "main/ssr-stages" ["def" "ssr-stages" ["let" [["ssr-element" [".querySelector" "js/document" "|#ssr-stages"]] ["ssr-markup" [".getAttribute" "ssr-element" "|content"]]] ["read-string" "ssr-markup"]]], "main/render-canvas-app!" ["defn" "render-canvas-app!" [] ["render-canvas!" ["comp-canvas" "@store-ref"] "@states-ref" "@instants-ref" "scene"] [".render" "@renderer-ref" "scene" "@camera-ref"]], "comp.container/comp-container" ["def" "comp-container" ["create-comp" ":container" ["fn" ["store"] ["fn" ["state" "mutate!"] ["div" ["{}" [":style" ["merge" "ui/global"]]] ["canvas" ["{}" [":attrs" ["{}" [":id" "|canvas"] [":width" "js/window.innerWidth"] [":height" "js/window.innerHeight"]]] [":style" ["{}"]]]]]]]]], "dsl.object3d-dom/set-material" ["defn" "set-material" []], "dsl.alias/cuboid" ["defn" "cuboid" ["props" "&" "children"] ["create-element" ":cuboid" "props" "children"]], "main/store-ref" ["defonce" "store-ref" ["atom" ["{}"]]], "main/scene" ["defonce" "scene" ["js/THREE.Scene."]], "types/Component" ["defrecord" "Component" ["name" "args" "states" "instants" "render" "tree" "hooks" "removing?"]], "dsl.render/render-markup" ["defn" "render-markup" ["markup" "prev-markup" "coord" "comp-coord" "states" "instants"] ["if" ["comp?" "markup"] ["render-component" "markup" "prev-markup" "coord" "states" "instants"] ["render-shape" "markup" "prev-markup" "coord" "coord" "states" "instants"]]], "util.core/comp?" ["defn" "comp?" ["x"] ["=" "Component" ["type" "x"]]], "dsl.object3d-dom/create-material" ["defn" "create-material" []], "types/Shape" ["defrecord" "Shape" ["name" "props" "children"]], "dsl.diff/diff-events" ["defn" "diff-events" ["prev-events" "events" "coord" "collect!"] ["let" [["prev-event-names" ["into" ["#{}"] ["keys" "prev-events"]]] ["event-names" ["into" ["#{}"] ["keys" "events"]]] ["added-events" ["set/difference" "event-names" "prev-event-names"]] ["removed-events" ["set/difference" "prev-event-names" "event-names"]]] ["if" ["not" ["empty?" "added-events"]] ["collect!" ["[]" "coord" ":add-events" "added-events"]]] ["if" ["not" ["empty?" "removed-events"]] ["collect!" ["[]" "coord" ":remove-events" "removed-events"]]]]], "dsl.object3d-dom/append-child" ["defn" "append-child" []], "dsl.diff/diff-material" ["defn" "diff-material" ["prev-material" "material" "coord" "collect!"] "nil"], "main/states-ref" ["defonce" "states-ref" ["atom" ["{}"]]], "dsl.alias/line" ["defn" "line" ["props" "&" "children"] ["create-element" ":line" "props" "children"]], "main/renderer-ref" ["defonce" "renderer-ref" ["atom" "nil"]], "main/instants-ref" ["defonce" "instants-ref" ["atom" ["{}"]]], "util.core/shape?" ["defn" "shape?" ["x"] ["=" "Shape" ["type" "x"]]], "dsl.alias/light" ["defn" "light" ["props" "&" "children"] ["create-element" ":light" "props" "children"]], "core/tree-ref" ["defonce" "tree-ref" ["atom" "nil"]], "dsl.diff/diff-tree" ["defn" "diff-tree" ["prev-tree" "tree" "coord" "collect!"] ["if" ["some?" "prev-tree"] ["if" ["some?" "tree"] ["do" ["diff-params" [":params" "prev-tree"] [":params" "tree"] "coord" "collect!"] ["diff-material" [":material" "prev-tree"] [":material" "tree"] "coord" "collect!"] ["diff-events" [":event" "prev-tree"] [":event" "tree"] "coord" "collect!"]] ["collect!" ["[]" "coord" ":remove"]]] ["if" ["some?" "tree"] ["collect!" ["[]" ":create" "tree"]] "nil"]]], "dsl.object3d-dom/set-param" ["defn" "set-param" []], "dsl.alias/basic-hooks" ["def" "basic-hooks" ["{}" [":init-state" ["fn" ["&" "args"] ["{}"]]] [":init-instant" ["fn" ["&" "args"] ["{}"]]] [":on-mutate" "merge"] [":on-update" "merge"] [":on-tick" ["fn" []]] [":on-update" ["fn" []]] [":on-unmount" ["fn" []]] [":remove?" ["fn" [] "false"]]]]}, :namespaces {"dsl.diff" ["ns" "quatrefoil.dsl.diff" [":require" ["[]" "clojure.set" ":as" "set"]]], "comp.canvas" ["ns" "quatrefoil.comp.canvas" [":require" ["[]" "quatrefoil.dsl.alias" ":refer" ["[]" "create-comp" "group" "cube"]]]], "util.core" ["ns" "quatrefoil.util.core" [":require" ["[]" "quatrefoil.types" ":refer" ["[]" "Component" "Shape"]]]], "comp.container" ["ns" "quatrefoil.comp.container" [":require" ["[]" "hsl.core" ":refer" ["[]" "hsl"]] ["[]" "respo-ui.style" ":as" "ui"] ["[]" "respo.alias" ":refer" ["[]" "create-comp" "div" "span" "canvas"]] ["[]" "respo.comp.space" ":refer" ["[]" "comp-space"]] ["[]" "respo.comp.text" ":refer" ["[]" "comp-text"]]]], "types" ["ns" "quatrefoil.types"], "main" ["ns" "quatrefoil.main" [":require" ["[]" "respo.core" ":refer" ["[]" "render!" "clear-cache!" "falsify-stage!" "render-element" "gc-states!"]] ["[]" "quatrefoil.comp.container" ":refer" ["[]" "comp-container"]] ["[]" "cljs.reader" ":refer" ["[]" "read-string"]] ["[]" "quatrefoil.core" ":refer" ["[]" "render-canvas!"]] ["[]" "quatrefoil.comp.canvas" ":refer" ["[]" "comp-canvas"]] ["[]" "devtools.core" ":as" "devtools"] ["[]" "cljsjs.three"] ["[]" "quatrefoil.dsl.object3d-dom" ":refer" ["[]" "camera-ref"]]]], "dsl.object3d-dom" ["ns" "quatrefoil.dsl.object3d-dom" [":require" ["[]" "cljsjs.three"] ["[]" "quatrefoil.util.core" ":refer" ["[]" "purify-tree"]]]], "core" ["ns" "quatrefoil.core" [":require" ["[]" "quatrefoil.dsl.render" ":refer" ["[]" "render-component"]] ["[]" "quatrefoil.dsl.diff" ":refer" ["[]" "diff-tree"]] ["[]" "quatrefoil.dsl.object3d-dom" ":refer" ["[]" "build-tree"]] ["[]" "quatrefoil.util.core" ":refer" ["[]" "purify-tree"]]]], "dsl.alias" ["ns" "quatrefoil.dsl.alias" [":require" ["[]" "quatrefoil.types" ":refer" ["[]" "Shape" "Component"]]]], "dsl.render" ["ns" "quatrefoil.dsl.render" [":require" ["[]" "quatrefoil.util.core" ":refer" ["[]" "comp?" "shape?" "=seq?"]]]]}, :procedures {"dsl.diff" [], "dsl" [], "comp.canvas" [], "util.core" [], "types" [], "main" [["set!" [".-onload" "js/window"] "-main!"]], "render.object3d-dom" [], "alias" [], "core" [], "dsl.alias" [], "dsl.render" []}, :package "quatrefoil"}